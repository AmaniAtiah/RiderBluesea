package com.barmej.riderbluesea;import android.content.Intent;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.TextView;import androidx.annotation.NonNull;import androidx.annotation.Nullable;import androidx.cardview.widget.CardView;import androidx.fragment.app.Fragment;import com.google.firebase.database.DataSnapshot;import com.google.firebase.database.DatabaseError;import com.google.firebase.database.FirebaseDatabase;import com.google.firebase.database.ValueEventListener;import static com.barmej.riderbluesea.TripListFragment.TRIP_REF_PATH;public class CurrentTripFragment extends Fragment {    private static final int INITIAL_STATUS_EXTRA = 123;    private CardView materialCardView;    private TextView fromCountryTextView;    private TextView toCountryTextView;    private TextView dateTextView;    private OnTriCardClickListener onTriCardClickListener;    private Trip trip;    @Nullable    @Override    public View onCreateView(@NonNull LayoutInflater inflater,@Nullable ViewGroup container,@Nullable Bundle savedInstanceState) {        return inflater.inflate(R.layout.fragment_current_trip,container,false);    }    @Override    public void onViewCreated(@NonNull View view,@Nullable Bundle savedInstanceState) {        super.onViewCreated(view,savedInstanceState);        materialCardView = view.findViewById(R.id.materialCardView);        fromCountryTextView = view.findViewById(R.id.from_country_text_view);        toCountryTextView = view.findViewById(R.id.to_country_text_view);        dateTextView = view.findViewById(R.id.date_text_view);        FirebaseDatabase firebaseDatabase = FirebaseDatabase.getInstance();        firebaseDatabase.getReference(TRIP_REF_PATH).addValueEventListener(new ValueEventListener() {            @Override            public void onDataChange(@NonNull DataSnapshot snapshot) {                //  mTrips.clear();                for (DataSnapshot dataSnapshot : snapshot.getChildren()) {                    trip = dataSnapshot.getValue(Trip.class);                    if (trip.getStatus().equals(Trip.Status.START_TRIP.name()) &&                            Global.CURRENT_USER.getReservedTrips().containsKey(trip.getId())) {                        materialCardView.setVisibility(View.VISIBLE);                        fromCountryTextView.setText(trip.getFromCountry());                        toCountryTextView.setText(trip.getToCountry());                        dateTextView.setText(trip.getFormattedDate());                    } else if (trip.getStatus().equals(Trip.Status.ARRIVED.name())) {                        materialCardView.setVisibility(View.GONE);                    }                }            }            @Override            public void onCancelled(@NonNull DatabaseError error) {            }        });        getOnTripCard();        setOnTriCardClickListener(onTriCardClickListener);        materialCardView.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                tripClick(trip);            }        });    }    private void tripClick(Trip trip) {        if (onTriCardClickListener != null) {            onTriCardClickListener.onTriCardClick(trip);        }    }    private void getOnTripCard() {        onTriCardClickListener = new OnTriCardClickListener() {            @Override            public void onTriCardClick(Trip trip) {                onClickButton(trip);            }        };    }    private void onClickButton(Trip trip) {        Intent intent = new Intent(getContext(), TripDetailsActivity.class);        intent.putExtra(TripDetailsActivity.TRIP_DATA, trip);        startActivity(intent);    }    public void setOnTriCardClickListener(OnTriCardClickListener onTriCardClickListener) {        this.onTriCardClickListener = onTriCardClickListener;    }}